create database accountdb;
create database inventorydb;
create database shippingdb;
=================================================================
/c inventorydb

Inventory db

tables
Product,Location,Stock, Product type

Create Type ProductType As Enum('Electronics','Garments','Furniture', 'Kitchen Appliances');


Create table Product(Product_Id bigserial Primary Key, Product_Name varchar(150) Not Null, 
Buffer_level smallint constraint buffer_level_constr Check(Buffer_level>0), Product_Type ProductType);

insert into Product(Product_Name,Buffer_level,Product_Type) values('Laptop',100,'Electronics');



Create table Location(Regional_Code smallint primary key , Address text not null, Contact_Number bigint);

insert into location (Regional_Code,Address,Contact_Number) values (44,'Mylapore, Chennai-5',1234567890);

to list the tables
\dt

to list the realtions for specific table
\dt+ location

to describe the table

\d product

create sequence invoice_no_seq AS bigint;

Create table Stock(Invoice_No bigint NOT NULL DEFAULT nextval('invoice_no_seq') primary key, DOP date, Qty smallint, Cost bigint, Product_Id bigint references product(Product_Id), Regional_Code smallint references location(Regional_code));

insert into Stock (DOP,Qty,Cost,Product_Id,Regional_Code) values('2021-02-22',65,45000,1,44);


Switch to Shipping db
\c shippingdb
tables
stockstatushistory,deliveryschedule

create table StockStatusHistory(History_Id bigserial primary key, Product_Id bigint,
Qty bigint, Stock_SnapShot timestamptz);  

insert into StockStatusHistory (Product_Id, Stock_SnapShot) values (1,
now());


create table DeliverySchedule(Schedule_Id bigserial primary key, Product_Id bigint, Requested_Delivery_Date date, Planned_Delivery_Date date, Available_Qty bigint);

insert into DeliverySchedule (Product_Id,Requested_Delivery_Date,Planned_Delivery_Date, Available_Qty) values(1,'2021-04-10','2021-04-12',100);


\accountdb
tables
transaction,purchaseorder

create table ProductTransaction(Transaction_Id bigserial primary key,

Transaction_Date_Time timestamptz, Amount bigint, Mode varchar(50), 

Status Boolean);


insert into ProductTransaction (Transaction_Date_Time,Amount,Mode,Status) values (now(),10000,'Cash',true);




create table Customer(Customer_Id bigserial primary key, Customer_info jsonb not null);

insert into Customer (Customer_info) values ('{
    "id": 1,
    "name": "Leanne Graham",
    "username": "Bret",
    "email": "Sincere@april.biz",
    "address": {
      "street": "Kulas Light",
      "suite": "Apt. 556",
      "city": "Gwenborough",
      "zipcode": "92998-3874",
      "geo": {
        "lat": "-37.3159",
        "lng": "81.1496"
      }
    },
    "phone": "1-770-736-8031 x56442",
    "website": "hildegard.org",
    "company": {
      "name": "Romaguera-Crona",
      "catchPhrase": "Multi-layered client-server neural-net",
      "bs": "harness real-time e-markets"
    }
  }');





create table GlobalCountryInfo(CountryCode smallint primary key,
Country_State text [] []);



insert into GlobalCountryInfo (CountryCode,Country_State) values(91,'{{"India","TamilNadu"},{"India","Karnataka"}}');


create table StarRating(Rating xml);

INSERT INTO StarRating (Rating) VALUES(
'<Ratings>
<BelowAverage>1</BelowAverage>
<Average>2</Average>
<Good>3</Good>
<VeryGood>4</VeryGood>
<Excellent>5</Excellent>
</Ratings>'
);

select age( Planned_Delivery_Date,Requested_Delivery_Date) from DeliverySchedule where Schedule_Id=1;

select age( Planned_Delivery_Date) from DeliverySchedule where Schedule_Id=1;

SELECT date_part('hour', Transaction_Date_Time) from ProductTransaction where Transaction_Id=1;


SELECT Customer_info  -> 'email',Customer_info -> 'address' AS Email
FROM Customer
WHERE Customer_Id=1;

update Customer set Customer_info=replace(Customer_Info::TEXT,':"Sincere@april.biz"',':"Param@gmail.com"')::jsonb


